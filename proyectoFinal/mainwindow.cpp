#include "mainwindow.h"
#include <QVector>
#include "QGraphicsPixmapItem"
#include "jugador.h"
#include "ui_mainwindow.h"

MainWindow::MainWindow(QWidget *parent)
    : QMainWindow(parent)
    , ui(new Ui::MainWindow)
{
    ui->setupUi(this);
    resize(700, 700);
    scene = new QGraphicsScene(this);
    view = new QGraphicsView(scene, this);
    view->setFixedSize(700, 700);
    view->setScene(scene);
    view->setHorizontalScrollBarPolicy(Qt::ScrollBarAlwaysOff);
    view->setVerticalScrollBarPolicy(Qt::ScrollBarAlwaysOff);
    nivel1();
}

MainWindow::~MainWindow()
{
    delete ui;
}

void MainWindow::crearMurosLaberinto()
{
    QVector<QRectF> posicionesMuros
        = {{44, 0, 14, 280}, {44, 266, 126, 14}, {44, 86, 83, 14}, {98, 0, 14, 58},
           {150, 0, 14, 146}, {98, 132, 74, 14}, {98, 132, 14, 14}, {44, 179, 71, 14},
           {0, 312, 61, 14}, {98, 312, 68, 14}, {151, 266, 14, 53}, {98, 310, 14, 148},
           {151, 179, 14, 58}, {209, 45, 14, 133}, {151, 179, 270, 14}, {209, 86, 101, 14},
           {209, 45, 35, 14}, {333, 0, 14, 193}, {333, 45, 92, 14}, {391, 86, 14, 62},
           {448, 86, 14, 62}, {391, 128, 62, 14}, {209, 220, 14, 147}, {209, 220, 47, 14},
           {151, 353, 69, 14}, {151, 353, 14, 58}, {98, 397, 70, 14}, {0, 445, 115, 14},
           {98, 131, 14, 61}, {271, 445, 14, 57}, {209, 445, 79, 14}, {209, 397, 14, 62},
           {274, 310, 14, 101}, {274, 397, 59, 14}, {316, 397, 14, 189}, {287, 266, 174, 14},
           {312, 220, 153, 14}, {448, 220, 14, 60}, {391, 266, 14, 58}, {333, 310, 75, 14},
           {333, 310, 14, 41}, {465, 0, 14, 59}, {465, 45, 72, 14}, {482, 310, 75, 14},
           {493, 86, 14, 151}, {493, 86, 101, 14}, {493, 220, 185, 14}, {540, 266, 69, 14},
           {540, 220, 14, 63}, {44, 488, 247, 14}, {540, 128, 14, 44}, {540, 128, 117, 14},
           {649, 128, 14, 65}, {649, 179, 266, 14}, {898, 86, 14, 110}, {783, 0, 14, 103},
           {578, 45, 14, 58}, {578, 45, 222, 14}, {707, 45, 14, 100}, {707, 128, 148, 14},
           {783, 179, 14, 58}, {898, 45, 79, 14}, {151, 843, 14, 181}, {943, 179, 81, 14},
           {960, 310, 64, 14}, {960, 220, 14, 107}, {842, 220, 135, 14}, {898, 266, 14, 220},
           {810, 397, 212, 14}, {810, 397, 14, 108}, {763, 266, 166, 14}, {810, 266, 14, 61},
           {707, 310, 120, 14}, {707, 220, 14, 63}, {649, 266, 75, 14}, {649, 266, 14, 101},
           {649, 353, 75, 14}, {707, 353, 14, 106}, {707, 445, 75, 14}, {761, 397, 37, 14},
           {785, 353, 14, 58}, {785, 353, 47, 14}, {960, 488, 64, 14}, {960, 488, 14, 57},
           {759, 531, 201, 14}, {759, 488, 14, 57}, {707, 488, 60, 14}, {707, 488, 14, 98},
           {898, 572, 62, 14}, {960, 619, 64, 14}, {873, 619, 42, 14}, {873, 619, 14, 242},
           {873, 843, 47, 14}, {911, 843, 14, 57}, {810, 531, 14, 203}, {917, 663, 60, 14},
           {917, 663, 14, 61}, {917, 710, 60, 14}, {960, 710, 14, 45}, {960, 800, 64, 14},
           {759, 572, 14, 91}, {810, 755, 78, 14}, {960, 887, 64, 14}, {960, 868, 14, 82},
           {919, 936, 41, 14}, {707, 710, 117, 14}, {707, 619, 14, 109}, {669, 619, 55, 14},
           {675, 755, 14, 195}, {810, 936, 14, 88}, {810, 936, 66, 14}, {810, 800, 14, 104},
           {759, 800, 56, 14}, {759, 755, 14, 62}, {759, 887, 68, 14}, {759, 887, 14, 63},
           {729, 936, 45, 14}, {557, 755, 220, 14}, {674, 843, 62, 14}, {575, 936, 114, 14},
           {575, 663, 95, 14}, {608, 663, 14, 106}, {608, 800, 14, 57}, {557, 755, 14, 45},
           {540, 843, 76, 14}, {540, 843, 14, 58}, {493, 887, 64, 14}, {493, 887, 14, 137},
           {364, 663, 146, 14}, {274, 619, 90, 14}, {391, 663, 14, 61}, {391, 710, 59, 14},
           {493, 663, 14, 151}, {432, 800, 78, 14}, {432, 800, 14, 101}, {239, 936, 210, 14},
           {0, 936, 168, 14}, {960, 45, 14, 83}, {151, 887, 140, 14}, {391, 887, 14, 63},
           {333, 887, 75, 14}, {333, 843, 14, 58}, {232, 843, 118, 14}, {333, 755, 111, 14},
           {391, 755, 14, 88}, {274, 800, 134, 14}, {274, 755, 14, 59}, {98, 531, 161, 14},
           {44, 488, 14, 141}, {0, 619, 61, 14}, {64, 572, 104, 14}, {209, 579, 121, 14},
           {125, 572, 14, 73}, {209, 572, 14, 105}, {274, 572, 14, 57}, {161, 619, 65, 14},
           {151, 663, 75, 14}, {98, 619, 14, 109}, {44, 710, 71, 14}, {44, 710, 14, 59},
           {151, 663, 14, 106}, {98, 755, 193, 14}, {209, 710, 82, 14}, {274, 663, 14, 61},
           {274, 663, 47, 14}, {311, 663, 14, 61}, {311, 710, 45, 14}, {98, 800, 14, 101},
           {61, 887, 54, 14}, {0, 800, 223, 14}, {0, 843, 61, 14}, {56, 98, 30, 30},
           {42, 381, 30, 30}, {44, 662, 30, 30}, {221, 490, 30, 30}, {219, 946, 30, 30},
           {333, 98, 30, 30}, {256, 266, 30, 30}, {366, 804, 30, 30}, {416, 716, 30, 30},
           {579, 173, 30, 30}, {626, 89, 30, 30}, {626, 892, 30, 30}, {651, 710, 30, 30},
           {721, 221, 30, 30}, {722, 690, 30, 30}, {835, 50, 30, 30}, {854, 312, 30, 30},
           {845, 441, 30, 30}, {942, 47, 30, 30}, {960, 354, 30, 30}, {960, 870, 30, 30},
           {0, 755, 44, 14}};

    for (const QRectF &datosMuros : posicionesMuros) {
        QGraphicsRectItem *muro = new QGraphicsRectItem(datosMuros);
        muro->setScale(0.683);
        muro->setBrush(Qt::NoBrush); //relleno invisible
        muro->setPen(Qt::NoPen); //borde invisible
        scene->addItem(muro);
    }
}

void MainWindow::nivel1()
{
    //crear el laberinto
    QPixmap imagenLaberinto(":/multimedia/laberinto.png");
    QPixmap imagenEscaladaLaberinto = imagenLaberinto.scaled(700, 700);
    QGraphicsPixmapItem *laberinto = new QGraphicsPixmapItem(imagenEscaladaLaberinto);
    laberinto->setZValue(-100);
    scene->addItem(laberinto);
    scene->setSceneRect(laberinto->boundingRect());
    crearMurosLaberinto();

    //agregar al jugador
    QPixmap spriteGoku(":/multimedia/goku.png");
    Jugador *goku = new Jugador(spriteGoku);
    scene->addItem(goku);
    goku->setFocus();
    goku->setPos(187, 87);
}
